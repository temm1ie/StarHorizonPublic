- type: entity
  id: MobShadowsBase
  parent: [ BaseMob, MobCombat ]
  abstract: true
  name: теневые Персоны
  description: Неизвестно...
  components:
  - type: HTN
    rootTask:
      task: SimpleRangedHostileCompound
    blackboard:
      NavClimb: !type:Bool
        true
      NavSmash: !type:Bool
        true
  - type: Tag
    tags:
      - CannotSuicide
      - DoorBumpOpener
      - FootstepSound
  - type: NpcFactionMember
    factions:
    - SimpleHostile
  - type: MovementSpeedModifier
    baseWalkSpeed: 3.5
    baseSprintSpeed: 3.5
  - type: Sprite
    layers:
    - map: [ "enum.DamageStateVisualLayers.Base" ]
      state: running
    - map: [ "enum.DamageStateVisualLayers.BaseUnshaded" ]
      state: running_un
      shader: unshaded
  - type: MobState
  - type: SlowOnDamage
    speedModifierThresholds:
      20: 0.5
  - type: DamageStateVisuals
    states:
      Alive:
        Base: running
        BaseUnshaded: running_un
      Dead:
        Base: dead
  - type: StatusEffects
    allowed:
    - Stun
    - Corporeal
    - Electrocution
    - StaminaModifier
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeCircle
          radius: 0.35
        density: 60
        mask:
          - MobMask
        layer:
          - Opaque
  - type: Damageable
    damageContainer: Inorganic
    damageModifierSet: LivingLight
  - type: PassiveDamage
    allowedStates:
    - Alive
    damageCap: 100
    damage:
      types:
        Heat: -1
      groups:
        Brute: -0.2
        Toxin: -1
        Airloss: 1
        Burn: -0.2
  - type: NoSlip
  - type: Pullable
  - type: ZombieImmune
  - type: NameIdentifier
    group: GenericNumber
  - type: GhostTakeoverAvailable
  - type: Speech
    speechVerb: Ghost
# Лут пока не сделан Ибо бубубу
  - type: Destructible
    thresholds:
      - trigger:
          !type:DamageTrigger
          damage: 100
        behaviors:
          - !type:DoActsBehavior
            acts: [ "Destruction" ]
          - !type:PlaySoundBehavior
           sound:
             path: /Audio/Effects/demon_dies.ogg
          - !type:SpawnEntitiesBehavior
            spawn:
              Ash:
                min: 1
                max: 1

- type: entity
  id: MobShadowRavager
  parent: MobShadowsBase
  name: опустошитель
  description: Воплощение созданий из пустоты, является одним из самых примитивных обитателей впадины.
  suffix: Бездна| Измерение Забвения
  components:
  - type: MovementSpeedModifier
    baseWalkSpeed: 4.5
    baseSprintSpeed: 4.5
  - type: Sprite
    sprite: _Horizon/Events/Oblivion/Monsters/Shadows1.rsi
    layers:
    - map: [ "enum.DamageStateVisualLayers.Base" ]
      state: running
    - map: [ "enum.DamageStateVisualLayers.BaseUnshaded" ]
      state: running_un
      shader: unshaded
  - type: DamageStateVisuals
    states:
      Alive:
        Base: running
        BaseUnshaded: running_un
      Dead:
        Base: dead
  - type: MeleeWeapon
    damage:
      types:
        Cold: 1.5
        Bloodloss: 1.5
        Poison: 0.5

- type: entity
  id: MobShadowObserver
  parent: MobShadowsBase
  name: наблюдатель
  description: Он наблюдает за вами.
  suffix: Бездна| Измерение Забвения
  components:
  - type: MovementSpeedModifier
    baseWalkSpeed: 1
    baseSprintSpeed: 1
  - type: Sprite
    sprite: _Horizon/Events/Oblivion/Monsters/Shadows2.rsi
    layers:
    - map: [ "enum.DamageStateVisualLayers.Base" ]
      state: running
    - map: [ "enum.DamageStateVisualLayers.BaseUnshaded" ]
      state: running_un
      shader: unshaded
  - type: DamageStateVisuals
    states:
      Alive:
        Base: running
        BaseUnshaded: running_un
      Dead:
        Base: dead
  - type: MeleeWeapon
    damage:
      types:
        Cold: 1.5
        Bloodloss: 1.5
        Poison: 0.5
        Cellular: 0.5
  - type: Destructible
    thresholds:
      - trigger:
          !type:DamageTrigger
          damage: 1000
        behaviors:
          - !type:DoActsBehavior
            acts: [ "Destruction" ]
          - !type:PlaySoundBehavior
           sound:
             path: /Audio/Effects/demon_attack1.ogg
          - !type:SpawnEntitiesBehavior
            spawn:
              Ash:
                min: 1
                max: 3

- type: entity
  id: MobShadowdivider
  parent: MobShadowsBase
  name: рассекатель
  description: Продвинутая версия обычных пустых, не имеет личности но имеет злой умысел.
  suffix: Бездна| Измерение Забвения
  components:
  - type: MovementSpeedModifier
    baseWalkSpeed: 4.5
    baseSprintSpeed: 4.5
  - type: Sprite
    sprite: _Horizon/Events/Oblivion/Monsters/Shadows3.rsi
    layers:
    - map: [ "enum.DamageStateVisualLayers.Base" ]
      state: running
    - map: [ "enum.DamageStateVisualLayers.BaseUnshaded" ]
      state: running_un
      shader: unshaded
  - type: DamageStateVisuals
    states:
      Alive:
        Base: running
        BaseUnshaded: running_un
      Dead:
        Base: dead
  - type: MeleeWeapon
    damage:
      types:
        Poison: 1.5
  - type: SlowOnDamage
    speedModifierThresholds:
      100: 0.5
  - type: Destructible
    thresholds:
      - trigger:
          !type:DamageTrigger
          damage: 250
        behaviors:
          - !type:DoActsBehavior
            acts: [ "Destruction" ]
          - !type:PlaySoundBehavior
           sound:
             path: /Audio/Effects/demon_attack1.ogg
          - !type:SpawnEntitiesBehavior
            spawn:
              Ash:
                min: 1
                max: 3

- type: entity
  id: MobShadowGuards
  parent: MobShadowsBase
  name: страж
  description: Страж впадины, на удивление он гораздо сильнее некоторых..
  suffix: Бездна| Измерение Забвения
  components:
  - type: SlowOnDamage
    speedModifierThresholds:
      20: 0.9
  - type: MovementSpeedModifier
    baseWalkSpeed: 5
    baseSprintSpeed: 5
  - type: Sprite
    sprite: _Horizon/Events/Oblivion/Monsters/Shadows3.rsi
    layers:
    - map: [ "enum.DamageStateVisualLayers.Base" ]
      state: running02
    - map: [ "enum.DamageStateVisualLayers.BaseUnshaded" ]
      state: running02
      shader: unshaded
  - type: DamageStateVisuals
    states:
      Alive:
        Base: running02
      Dead:
        Base: dead02
  - type: MeleeWeapon
    damage:
      types:
        Poison: 1.5
        Cold: 2.5
        Bloodloss: 2.5
  - type: Destructible
    thresholds:
      - trigger:
          !type:DamageTrigger
          damage: 250
        behaviors:
          - !type:DoActsBehavior
            acts: [ "Destruction" ]
          - !type:PlaySoundBehavior
           sound:
             path: /Audio/Effects/demon_attack1.ogg
          - !type:SpawnEntitiesBehavior
            spawn:
              Ash:
                min: 1
                max: 4

- type: entity
  id: MobShadowBlind
  parent: MobShadowsBase
  name: незрячий
  description: Его вид заставляет впасть вас в шок.. Кажется или он вас не может заметить.. Может просто уйти?
  suffix: Бездна| Измерение Забвения
  components:
  - type: SlowOnDamage
    speedModifierThresholds:
      20: 0.9
  - type: MovementSpeedModifier
    baseWalkSpeed: 2.5
    baseSprintSpeed: 2.5
  - type: Sprite
    sprite: _Horizon/Events/Oblivion/Monsters/Shadows4.rsi
    layers:
    - map: [ "enum.DamageStateVisualLayers.Base" ]
      state: running
    - map: [ "enum.DamageStateVisualLayers.BaseUnshaded" ]
      state: running
      shader: unshaded
  - type: DamageStateVisuals
    states:
      Alive:
        Base: running
      Dead:
        Base: dead02
  - type: MeleeWeapon
    damage:
      types:
        Cold: 2.5
        Bloodloss: 5
  - type: Destructible
    thresholds:
      - trigger:
          !type:DamageTrigger
          damage: 450
        behaviors:
          - !type:DoActsBehavior
            acts: [ "Destruction" ]
          - !type:PlaySoundBehavior
           sound:
             path: /Audio/Effects/demon_attack1.ogg
          - !type:SpawnEntitiesBehavior
            spawn:
              Ash:
                min: 1
                max: 4

- type: entity
  id: MobShadowKinhgt
  parent: MobShadowsBase
  name: сверкающий рыцарь
  description: Совершенное существо из пустоты, предвестник истиного лика тьмы.
  suffix: Бездна| Измерение Забвения
  components:
  - type: SlowOnDamage
    speedModifierThresholds:
      20: 0.9
  - type: MovementSpeedModifier
    baseWalkSpeed: 7.5
    baseSprintSpeed: 5
  - type: Sprite
    sprite: _Horizon/Events/Oblivion/Monsters/Shadows5.rsi
    layers:
    - map: [ "enum.DamageStateVisualLayers.Base" ]
      state: running
    - map: [ "enum.DamageStateVisualLayers.BaseUnshaded" ]
      state: running
      shader: unshaded
  - type: DamageStateVisuals
    states:
      Alive:
        Base: running
      Dead:
        Base: dead
  - type: MeleeWeapon
    damage:
      types:
        Structural: 50
        Cold: 5
        Bloodloss: 7.5
  - type: Destructible
    thresholds:
      - trigger:
          !type:DamageTrigger
          damage: 500
        behaviors:
          - !type:DoActsBehavior
            acts: [ "Destruction" ]
          - !type:PlaySoundBehavior
           sound:
             path: /Audio/Effects/demon_attack1.ogg
          - !type:SpawnEntitiesBehavior
            spawn:
              Ash:
                min: 1
                max: 1

# MobShadowBlind, MobShadowGuards, MobShadowdivider, MobShadowObserver, MobShadowRavager

- type: entity
  parent: MarkerBase
  id: RandomShadowsMobs
  name: (легкие мобы) рандом спаунер теневых
  suffix: Спаунер | Измерение Забвения
  components:
  - type: Sprite
    layers:
    - state: green
    - sprite: _Horizon/Events/Oblivion/Monsters/Shadows3.rsi
      state: running02
  - type: EntityTableSpawner
    table: !type:GroupSelector
      children:
      - id: MobShadowRavager
        weight: 36
      - id: MobShadowObserver
        weight: 64

- type: entity
  parent: MarkerBase
  id: RandomShadowsMobsB
  name: (средние мобы) рандом спаунер теневых
  suffix: Спаунер | Измерение Забвения
  components:
  - type: Sprite
    layers:
    - state: green
    - sprite: _Horizon/Events/Oblivion/Monsters/Shadows3.rsi
      state: running02
  - type: EntityTableSpawner
    table: !type:GroupSelector
      children:
      - id: MobShadowRavager
        weight: 33
      - id: MobShadowdivider
        weight: 33
      - id: MobShadowGuards
        weight: 33

- type: entity
  parent: MarkerBase
  id: RandomShadowsMobsS
  name: (сложные мобы) рандом спаунер теневых
  suffix: Спаунер | Измерение Забвения
  components:
  - type: Sprite
    layers:
    - state: green
    - sprite: _Horizon/Events/Oblivion/Monsters/Shadows3.rsi
      state: running02
  - type: EntityTableSpawner
    table: !type:GroupSelector
      children:
      - id: MobShadowBlind
        weight: 10
      - id: MobShadowdivider
        weight: 50
      - id: MobShadowGuards
        weight: 40

- type: entity
  abstract: true
  id: OblivionMobOre
  name: мраконевые монстры
  parent: [ MobElementalBase, MobCombat ]
  components:
  - type: Sprite
    sprite: _Horizon/Events/Oblivion/Monsters/golems.rsi
    state: iron_golem
  - type: HTN
    rootTask:
      task: SimpleHostileCompound
  - type: MeleeWeapon
    hidden: true
    soundHit:
      path: /Audio/Weapons/Xeno/alien_claw_flesh3.ogg
    damage:
      types:
        Blunt: 2.5
        Cold: 2.5
        Bloodloss: 2.5
  - type: MovementSpeedModifier
    baseWalkSpeed : 2
    baseSprintSpeed : 2.5
  - type: NpcFactionMember
    factions:
      - SimpleHostile
  - type: Damageable
    damageContainer: StructuralInorganic
  - type: MovementIgnoreGravity
  - type: Appearance
  - type: StandingState
  - type: RotationVisuals
    defaultRotation: 90
    horizontalRotation: 90

- type: entity
  parent: OblivionMobOre
  id: MobGolemOblivion
  suffix: Измерение Забвения
  description: Мраконий проклятый бродить в бесконечной пустоши.
  name: мраконевый голем
  components:
  - type: Butcherable
    spawned:
    - id: RockRysOblivion
      amount: 1
    - id: trophiesgolem
      amount: 1
      prob: 0.2
  - type: Sprite
    state: iron_golem
  - type: MobThresholds
    thresholds:
      0: Alive
      150: Dead
  - type: Destructible
    thresholds:
    - trigger:
        !type:DamageTrigger
        damage: 175
      behaviors:
      - !type:PlaySoundBehavior
        sound:
          collection: GlassBreak
      - !type:DoActsBehavior
        acts: [ "Destruction" ]

- type: entity
  parent: OblivionMobOre
  id: MobCrabOblivion
  suffix: Измерение Забвения
  description: Жуткий.. И до ужаса острый..
  name: мраконевый краб
  components:
  - type: Butcherable
    spawned:
    - id: RockRysOblivion
      amount: 1
    - id: trophiescrabs
      amount: 1
      prob: 0.5
  - type: Sprite
    state: crab
  - type: MeleeWeapon
    hidden: true
    soundHit:
      path: /Audio/Weapons/Xeno/alien_claw_flesh3.ogg
    damage:
      types:
        Slash: 5
        Cold: 1.5
        Bloodloss: 1.5
  - type: MobThresholds
    thresholds:
      0: Alive
      75: Dead
  - type: MovementSpeedModifier
    baseWalkSpeed : 5
    baseSprintSpeed : 4.5
  - type: Destructible
    thresholds:
    - trigger:
        !type:DamageTrigger
        damage: 100
      behaviors:
      - !type:PlaySoundBehavior
        sound:
          collection: GlassBreak
      - !type:DoActsBehavior
        acts: [ "Destruction" ]

# Добри краб

- type: entity
  parent: OblivionMobOre
  id: MobCrabOblivionNtMini
  suffix: Измерение Забвения
  description: Жуткий.. И до ужаса острый.. Но кажется он ваш союзник?
  name: мраконевый краб
  components:
  - type: TimedDespawn
    lifetime: 180
  - type: NpcFactionMember
    factions:
    - Cat
    - NanoTrasen
  - type: Sprite
    state: crab
  - type: MeleeWeapon
    hidden: true
    soundHit:
      path: /Audio/Weapons/Xeno/alien_claw_flesh3.ogg
    damage:
      types:
        Slash: 2.5
        Cold: 1.5
        Bloodloss: 1.5
  - type: MobThresholds
    thresholds:
      0: Alive
      50: Dead
  - type: MovementSpeedModifier
    baseWalkSpeed : 4.5
    baseSprintSpeed : 4.5
  - type: Destructible
    thresholds:
    - trigger:
        !type:DamageTrigger
        damage: 100
      behaviors:
      - !type:PlaySoundBehavior
        sound:
          collection: GlassBreak
      - !type:DoActsBehavior
        acts: [ "Destruction" ]

- type: entity
  parent: OblivionMobOre
  id: MobMiniBossOblivion
  suffix: Мини-Босс | Измерение Забвения
  description: Каменный танк, абсолютное воплощение власти каменных существ.
  name: мраконевый колосс
  components:
  - type: Butcherable
    spawned:
    - id: RockRysOblivion
      amount: 2
    - id: trophiescollos
      amount: 1
      prob: 0.2
  - type: Sprite
    sprite: _Horizon/Events/Oblivion/Monsters/GolemsBoss.rsi
    state: golem
  - type: MeleeWeapon
    hidden: true
    soundHit:
      path: /Audio/Effects/break_stone.ogg
    damage:
      types:
        Blunt: 7.5
        Cold: 5.5
        Bloodloss: 2.5
  - type: MovementSpeedModifier
    baseWalkSpeed : 3.5
    baseSprintSpeed : 3.5
  - type: MobThresholds
    thresholds:
      0: Alive
      500: Dead
  - type: Destructible
    thresholds:
    - trigger:
        !type:DamageTrigger
        damage: 650
      behaviors:
      - !type:PlaySoundBehavior
        sound:
          collection: GlassBreak
      - !type:DoActsBehavior
        acts: [ "Destruction" ]
  - type: ActionGun
    action: ActionCrab
    gunProto: ActionCrabGun
  - type: NPCUseActionOnTarget
    actionId: ActionCrabGun

- type: entity
  categories: [ HideSpawnMenu ]
  id: ActionCrabGun
  name: Бросить часть себя
  description: Вы бросаете кусочек себя что преобразуется в краба
  components:
  - type: RechargeBasicEntityAmmo
    rechargeCooldown: 10
    rechargeSound:
      path: /Audio/Effects/break_stone.ogg
  - type: BasicEntityAmmoProvider
    proto: MobCrabOblivion
    capacity: 1
    count: 1
  - type: Gun
    soundGunshot:
      path: /Audio/Effects/break_stone.ogg
    soundEmpty: null
    projectileSpeed: 10
- type: entity
  id: ActionCrab
  name: Бросить часть себя
  description: Вы бросаете кусочек себя что преобразуется в краба
  components:
  - type: Action
    icon: { sprite : _NF/Objects/Fun/petrock.rsi, state: rock }
    priority: 2
    itemIconStyle: BigAction
  - type: TargetAction
    checkCanAccess: false
    range: 0
  - type: WorldTargetAction
    event: !type:ActionGunShootEvent

# region БОСС

# region первая фаза

- type: entity
  parent: OblivionMobOre
  id: MobBossOblivions
  suffix: Босс | Измерение Забвения
  description: Абсолютное воплощение доминирования и власти.
  name: мраконевый титан
  components:
  - type: Butcherable
    spawned:
    - id: RockRysOblivion
      amount: 5
    - id: MaterialBluespace
      amount: 2
      prob: 0.5
  - type: Sprite
    sprite: _Horizon/Events/Oblivion/Monsters/Titan.rsi
    state: golem
# Стрельба крабами \ Фишка первой фазы (ОН НЕ СТРЕЛЯЕТ ХНЫК)
  - type: MovementSpeedModifier
    baseWalkSpeed : 1.5
    baseSprintSpeed : 1.5
  - type: MobThresholds
    thresholds:
      0: Alive
      2500: Dead
  - type: Destructible
    thresholds:
      - trigger:
          !type:DamageTrigger
          damage: 2500
        behaviors:
          - !type:PlaySoundBehavior
           sound:
             path: /Audio/Effects/demon_attack1.ogg
          - !type:SpawnEntitiesBehavior
            spawn:
              MobBossSpawnFaza:
                min: 1
                max: 1
          - !type:DoActsBehavior
            acts: [ "Destruction" ]
  - type: ActionGun
    action: ActionCrab
    gunProto: ActionCrabGun
  - type: NPCUseActionOnTarget
    actionId: ActionCrabGun
  - type: MeleeWeapon
    attackRate: 1.2
    hidden: true
    soundHit:
      path: /Audio/Weapons/Xeno/alien_claw_flesh3.ogg
    damage:
      types:
        Structural: 100
        Blunt: 7.5
        Cold: 5.5
        Bloodloss: 2.5
    range: 2.3
  - type: PassiveDamage
    allowedStates:
    - Alive
    damageCap: 2500
    damage:
      types:
        Heat: -5
      groups:
        Brute: -0.2
        Toxin: -8
        Airloss: -8
        Burn: -0.2
  - type: ContentEye
    maxZoom: 2.0,2.0
  - type: Reflect
    reflectProb: 0.7
    reflects:
      - Energy
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeCircle
          radius: 0.9
        density: 300
        mask:
        - MobMask
        layer:
        - MobLayer
  - type: MobState
  - type: Tag
    tags:
      - CannotSuicide
      - DoorBumpOpener
      - FootstepSound

- type: entity
  parent: [ BaseMob, MobCombat ]
  id: MobBossSpawnFaza
  categories: [ HideSpawnMenu ]
  components:
  - type: Sprite
    sprite: _Horizon/Events/Oblivion/Monsters/Titan.rsi
    state: spawnfaza
  - type: TimedDespawn
    lifetime: 4.1
  - type: SpawnOnDespawn
    prototype: MobBossOblivionsFaza

# region Вторая фаза

- type: entity
  parent: OblivionMobOre
  id: MobBossOblivionsFaza
  suffix: Босс | Измерение Забвения
  description: Абсолютное воплощение доминирования и власти.
  name: мраконевый титан
  components:
  - type: Butcherable
    spawned:
    - id: CrateMrakoniRandom
      amount: 1
      prob: 0.9
    - id: RockRysOblivion
      amount: 5
    - id: trophiestitan
      amount: 1
      prob: 0.7
    - id: MaterialBluespace
      amount: 2
      prob: 0.5
  - type: Sprite
    sprite: _Horizon/Events/Oblivion/Monsters/Titan.rsi
    state: titan
  - type: MovementSpeedModifier
    baseWalkSpeed : 3.5
    baseSprintSpeed : 3.5
  - type: MobThresholds
    thresholds:
      0: Alive
      2900: Dead
  - type: Destructible
    thresholds:
      - trigger:
          !type:DamageTrigger
          damage: 3000
        behaviors:
          - !type:PlaySoundBehavior
           sound:
             path: /Audio/Effects/demon_attack1.ogg
          - !type:SpawnEntitiesBehavior
            spawn:
              RockRysOblivion:
                min: 1
                max: 1
          - !type:DoActsBehavior
            acts: [ "Destruction" ]
  - type: MeleeWeapon
    attackRate: 0.5
    hidden: true
    soundHit:
      path: /Audio/Weapons/Xeno/alien_claw_flesh3.ogg
    damage:
      types:
        Structural: 250
        Blunt: 15
        Cold: 2.5
        Bloodloss: 2.5
  - type: ActionGun
    action: ActionCrab
    gunProto: ActionCrabGun
  - type: NPCUseActionOnTarget
    actionId: ActionDragonsBreath
  - type: PassiveDamage
    allowedStates:
    - Alive
    damageCap: 1000
    damage:
      types:
        Heat: -5
      groups:
        Brute: -0.2
        Toxin: -8
        Airloss: -8
        Burn: -0.2
  - type: ContentEye
    maxZoom: 2.0,2.0
  - type: Reflect
    reflectProb: 0.9
    reflects:
      - Energy
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeCircle
          radius: 0.9
        density: 300
        mask:
        - MobMask
        layer:
        - MobLayer
  - type: MobState
  - type: Tag
    tags:
      - CannotSuicide
      - DoorBumpOpener
      - FootstepSound
